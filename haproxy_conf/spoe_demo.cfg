[demo]
spoe-agent demo
    log global

    max-frame-size 256 # tune.bufsize-4 == 16380

    messages msg-1 msg-2
    
    option set-on-error error
    option set-process-time process_time
    option set-total-time total_time

    option var-prefix spoe_demo
    timeout hello 50ms # AGENT-HELLO send failed after HAPROXY-HELLO received, error:[ Broken pipe (os error 32) ]
    timeout idle 20s # HAPROXY-DISCONNECT Errors[2] received; AGENT-DISCONNECT send successful; conn close successful.
    timeout processing 3s # ACK send failed after NOTIFY received, error:[ Broken pipe (os error 32) ]
    use-backend backend-spoa-demo

spoe-message msg-1
    args arg_method=method arg_path=url
    event on-frontend-http-request

spoe-message msg-2
    args arg_method=method arg_status=status arg_body=res.payload(0,16)
    event on-http-response
